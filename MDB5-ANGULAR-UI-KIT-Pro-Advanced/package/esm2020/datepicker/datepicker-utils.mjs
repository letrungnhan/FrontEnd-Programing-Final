export function getDate(date) {
    return date.getDate();
}
export function getDayNumber(date) {
    return date.getDay();
}
export function getMonth(date) {
    return date.getMonth();
}
export function getYear(date) {
    return date.getFullYear();
}
export function getFirstDayOfWeek(year, month, startDay) {
    const firstDayIndex = startDay;
    const sundayIndex = firstDayIndex > 0 ? 7 - firstDayIndex : 0;
    const date = new Date(year, month);
    const index = date.getDay() + sundayIndex;
    const newIndex = index >= 7 ? index - 7 : index;
    return newIndex;
}
export function getDaysInMonth(date) {
    return getMonthEnd(date).getDate();
}
export function getMonthEnd(date) {
    return createDate(date.getFullYear(), date.getMonth() + 1, 0);
}
export function getToday() {
    return new Date();
}
export function addYears(date, years) {
    return addMonths(date, years * 12);
}
export function addMonths(date, months) {
    const month = createDate(date.getFullYear(), date.getMonth() + months, date.getDate());
    const dayOfPreviousMonth = getDate(date);
    const dayOfNewMonth = getDate(month);
    // Solution for edge cases, like moving from a month with a greater number
    // of days than the destination month. For example, when we move from 31 Mar 2020 to
    // February, createDate(2020, 2, 31) will return 2 Mar 2020, not the desired 29 Feb 2020.
    // We need to use setDate(0) to move back to the last day of the previous month (29 Feb 2020)
    if (dayOfPreviousMonth !== dayOfNewMonth) {
        month.setDate(0);
    }
    return month;
}
export function addDays(date, days) {
    return createDate(date.getFullYear(), date.getMonth(), date.getDate() + days);
}
export function createDate(year, month, day) {
    const result = new Date(year, month, day);
    // In js native date years from 0 to 99 are treated as abbreviation
    // for dates like 19xx
    if (year >= 0 && year < 100) {
        result.setFullYear(result.getFullYear() - 1900);
    }
    return result;
}
export function convertStringToDate(dateString) {
    const dateArr = dateString.split('-');
    const year = Number(dateArr[0]);
    const month = Number(dateArr[1]);
    const day = Number(dateArr[2]);
    return createDate(year, month, day);
}
export function isValidDate(date) {
    return !Number.isNaN(date.getTime());
}
export function compareDates(date1, date2) {
    return (getYear(date1) - getYear(date2) ||
        getMonth(date1) - getMonth(date2) ||
        getDate(date1) - getDate(date2));
}
export function isSameDate(date1, date2) {
    date1.setHours(0, 0, 0, 0);
    date2.setHours(0, 0, 0, 0);
    return date1.getTime() === date2.getTime();
}
export function getYearsOffset(activeDate, yearsInView, minDate, maxDate) {
    const activeYear = getYear(activeDate);
    const yearsDifference = activeYear - getStartYear(yearsInView, minDate, maxDate);
    return modulo(yearsDifference, yearsInView);
}
function modulo(a, b) {
    return ((a % b) + b) % b;
}
export function getStartYear(yearsInView, minDate, maxDate) {
    let startYear = 0;
    if (maxDate) {
        const maxYear = getYear(maxDate);
        startYear = maxYear - yearsInView + 1;
    }
    else if (minDate) {
        startYear = getYear(minDate);
    }
    return startYear;
}
export function isDateDisabled(date, minDate, maxDate, filter) {
    const isBeforeMin = minDate && compareDates(date, minDate) <= 0;
    const isAfterMax = maxDate && compareDates(date, maxDate) >= 0;
    const isDisabled = filter && filter(date) === false;
    return isBeforeMin || isAfterMax || isDisabled;
}
export function isMonthDisabled(month, year, minDate, maxDate) {
    const maxYear = maxDate && getYear(maxDate);
    const maxMonth = maxDate && getMonth(maxDate);
    const minYear = minDate && getYear(minDate);
    const minMonth = minDate && getMonth(minDate);
    const isMonthAndYearAfterMax = maxMonth && maxYear && (year > maxYear || (year === maxYear && month > maxMonth));
    const isMonthAndYearBeforeMin = minMonth && minYear && (year < minYear || (year === minYear && month < minMonth));
    return isMonthAndYearAfterMax || isMonthAndYearBeforeMin;
}
export function isYearDisabled(year, minDate, maxDate) {
    const min = minDate && getYear(minDate);
    const max = maxDate && getYear(maxDate);
    const isAfterMax = max && year > max;
    const isBeforeMin = min && year < min;
    return isAfterMax || isBeforeMin;
}
export function isNextDateDisabled(activeDate, view, yearsInView, minDate, maxDate) {
    return maxDate && areDatesInSameView(activeDate, maxDate, view, yearsInView, minDate, maxDate);
}
export function isPreviousDateDisabled(activeDate, view, yearsInView, minDate, maxDate) {
    return minDate && areDatesInSameView(activeDate, minDate, view, yearsInView, minDate, maxDate);
}
export function areDatesInSameView(date1, date2, view, yearsInView, minDate, maxDate) {
    if (view === 'days') {
        return getYear(date1) === getYear(date2) && getMonth(date1) === getMonth(date2);
    }
    if (view === 'months') {
        return getYear(date1) === getYear(date2);
    }
    if (view === 'years') {
        const startYear = getStartYear(yearsInView, minDate, maxDate);
        return (Math.floor((getYear(date1) - startYear) / yearsInView) ===
            Math.floor((getYear(date2) - startYear) / yearsInView));
    }
    return false;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXBpY2tlci11dGlscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL21kYi1hbmd1bGFyLXVpLWtpdC9kYXRlcGlja2VyL2RhdGVwaWNrZXItdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxVQUFVLE9BQU8sQ0FBQyxJQUFVO0lBQ2hDLE9BQU8sSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBQ3hCLENBQUM7QUFFRCxNQUFNLFVBQVUsWUFBWSxDQUFDLElBQVU7SUFDckMsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDdkIsQ0FBQztBQUVELE1BQU0sVUFBVSxRQUFRLENBQUMsSUFBVTtJQUNqQyxPQUFPLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUN6QixDQUFDO0FBRUQsTUFBTSxVQUFVLE9BQU8sQ0FBQyxJQUFVO0lBQ2hDLE9BQU8sSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0FBQzVCLENBQUM7QUFFRCxNQUFNLFVBQVUsaUJBQWlCLENBQUMsSUFBWSxFQUFFLEtBQWEsRUFBRSxRQUFnQjtJQUM3RSxNQUFNLGFBQWEsR0FBRyxRQUFRLENBQUM7SUFDL0IsTUFBTSxXQUFXLEdBQUcsYUFBYSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzlELE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztJQUNuQyxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsV0FBVyxDQUFDO0lBQzFDLE1BQU0sUUFBUSxHQUFHLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztJQUNoRCxPQUFPLFFBQVEsQ0FBQztBQUNsQixDQUFDO0FBRUQsTUFBTSxV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bkIsT0FBYSxFQUNiLE9BQWE7SUFFYixJQUFJLElBQUksS0FBSyxNQUFNLEVBQUU7UUFDbkIsT0FBTyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDakY7SUFFRCxJQUFJLElBQUksS0FBSyxRQUFRLEVBQUU7UUFDckIsT0FBTyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQzFDO0lBRUQsSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFO1FBQ3BCLE1BQU0sU0FBUyxHQUFHLFlBQVksQ0FBQyxXQUFXLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRTlELE9BQU8sQ0FDTCxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLFNBQVMsQ0FBQyxHQUFHLFdBQVcsQ0FBQztZQUN0RCxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLFNBQVMsQ0FBQyxHQUFHLFdBQVcsQ0FBQyxDQUN2RCxDQUFDO0tBQ0g7SUFFRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZ2V0RGF0ZShkYXRlOiBEYXRlKTogbnVtYmVyIHtcbiAgcmV0dXJuIGRhdGUuZ2V0RGF0ZSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGF5TnVtYmVyKGRhdGU6IERhdGUpOiBudW1iZXIge1xuICByZXR1cm4gZGF0ZS5nZXREYXkoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vbnRoKGRhdGU6IERhdGUpOiBudW1iZXIge1xuICByZXR1cm4gZGF0ZS5nZXRNb250aCgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0WWVhcihkYXRlOiBEYXRlKTogbnVtYmVyIHtcbiAgcmV0dXJuIGRhdGUuZ2V0RnVsbFllYXIoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpcnN0RGF5T2ZXZWVrKHllYXI6IG51bWJlciwgbW9udGg6IG51bWJlciwgc3RhcnREYXk6IG51bWJlcik6IG51bWJlciB7XG4gIGNvbnN0IGZpcnN0RGF5SW5kZXggPSBzdGFydERheTtcbiAgY29uc3Qgc3VuZGF5SW5kZXggPSBmaXJzdERheUluZGV4ID4gMCA/IDcgLSBmaXJzdERheUluZGV4IDogMDtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoKTtcbiAgY29uc3QgaW5kZXggPSBkYXRlLmdldERheSgpICsgc3VuZGF5SW5kZXg7XG4gIGNvbnN0IG5ld0luZGV4ID0gaW5kZXggPj0gNyA/IGluZGV4IC0gNyA6IGluZGV4O1xuICByZXR1cm4gbmV3SW5kZXg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXlzSW5Nb250aChkYXRlOiBEYXRlKTogbnVtYmVyIHtcbiAgcmV0dXJuIGdldE1vbnRoRW5kKGRhdGUpLmdldERhdGUoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vbnRoRW5kKGRhdGU6IERhdGUpOiBEYXRlIHtcbiAgcmV0dXJuIGNyZWF0ZURhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCBkYXRlLmdldE1vbnRoKCkgKyAxLCAwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRvZGF5KCk6IERhdGUge1xuICByZXR1cm4gbmV3IERhdGUoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFllYXJzKGRhdGU6IERhdGUsIHllYXJzOiBudW1iZXIpOiBEYXRlIHtcbiAgcmV0dXJuIGFkZE1vbnRocyhkYXRlLCB5ZWFycyAqIDEyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZE1vbnRocyhkYXRlOiBEYXRlLCBtb250aHM6IG51bWJlcik6IERhdGUge1xuICBjb25zdCBtb250aCA9IGNyZWF0ZURhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCBkYXRlLmdldE1vbnRoKCkgKyBtb250aHMsIGRhdGUuZ2V0RGF0ZSgpKTtcbiAgY29uc3QgZGF5T2ZQcmV2aW91c01vbnRoID0gZ2V0RGF0ZShkYXRlKTtcbiAgY29uc3QgZGF5T2ZOZXdNb250aCA9IGdldERhdGUobW9udGgpO1xuXG4gIC8vIFNvbHV0aW9uIGZvciBlZGdlIGNhc2VzLCBsaWtlIG1vdmluZyBmcm9tIGEgbW9udGggd2l0aCBhIGdyZWF0ZXIgbnVtYmVyXG4gIC8vIG9mIGRheXMgdGhhbiB0aGUgZGVzdGluYXRpb24gbW9udGguIEZvciBleGFtcGxlLCB3aGVuIHdlIG1vdmUgZnJvbSAzMSBNYXIgMjAyMCB0b1xuICAvLyBGZWJydWFyeSwgY3JlYXRlRGF0ZSgyMDIwLCAyLCAzMSkgd2lsbCByZXR1cm4gMiBNYXIgMjAyMCwgbm90IHRoZSBkZXNpcmVkIDI5IEZlYiAyMDIwLlxuICAvLyBXZSBuZWVkIHRvIHVzZSBzZXREYXRlKDApIHRvIG1vdmUgYmFjayB0byB0aGUgbGFzdCBkYXkgb2YgdGhlIHByZXZpb3VzIG1vbnRoICgyOSBGZWIgMjAyMClcbiAgaWYgKGRheU9mUHJldmlvdXNNb250aCAhPT0gZGF5T2ZOZXdNb250aCkge1xuICAgIG1vbnRoLnNldERhdGUoMCk7XG4gIH1cblxuICByZXR1cm4gbW9udGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGREYXlzKGRhdGU6IERhdGUsIGRheXM6IG51bWJlcik6IERhdGUge1xuICByZXR1cm4gY3JlYXRlRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgZGF0ZS5nZXREYXRlKCkgKyBkYXlzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURhdGUoeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyLCBkYXk6IG51bWJlcik6IERhdGUge1xuICBjb25zdCByZXN1bHQgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5KTtcblxuICAvLyBJbiBqcyBuYXRpdmUgZGF0ZSB5ZWFycyBmcm9tIDAgdG8gOTkgYXJlIHRyZWF0ZWQgYXMgYWJicmV2aWF0aW9uXG4gIC8vIGZvciBkYXRlcyBsaWtlIDE5eHhcbiAgaWYgKHllYXIgPj0gMCAmJiB5ZWFyIDwgMTAwKSB7XG4gICAgcmVzdWx0LnNldEZ1bGxZZWFyKHJlc3VsdC5nZXRGdWxsWWVhcigpIC0gMTkwMCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRTdHJpbmdUb0RhdGUoZGF0ZVN0cmluZzogc3RyaW5nKTogRGF0ZSB7XG4gIGNvbnN0IGRhdGVBcnIgPSBkYXRlU3RyaW5nLnNwbGl0KCctJyk7XG4gIGNvbnN0IHllYXIgPSBOdW1iZXIoZGF0ZUFyclswXSk7XG4gIGNvbnN0IG1vbnRoID0gTnVtYmVyKGRhdGVBcnJbMV0pO1xuICBjb25zdCBkYXkgPSBOdW1iZXIoZGF0ZUFyclsyXSk7XG5cbiAgcmV0dXJuIGNyZWF0ZURhdGUoeWVhciwgbW9udGgsIGRheSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkRGF0ZShkYXRlOiBEYXRlKTogYm9vbGVhbiB7XG4gIHJldHVybiAhTnVtYmVyLmlzTmFOKGRhdGUuZ2V0VGltZSgpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVEYXRlcyhkYXRlMTogRGF0ZSwgZGF0ZTI6IERhdGUpOiBudW1iZXIge1xuICByZXR1cm4gKFxuICAgIGdldFllYXIoZGF0ZTEpIC0gZ2V0WWVhcihkYXRlMikgfHxcbiAgICBnZXRNb250aChkYXRlMSkgLSBnZXRNb250aChkYXRlMikgfHxcbiAgICBnZXREYXRlKGRhdGUxKSAtIGdldERhdGUoZGF0ZTIpXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NhbWVEYXRlKGRhdGUxOiBEYXRlLCBkYXRlMjogRGF0ZSk6IGJvb2xlYW4ge1xuICBkYXRlMS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgZGF0ZTIuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG5cbiAgcmV0dXJuIGRhdGUxLmdldFRpbWUoKSA9PT0gZGF0ZTIuZ2V0VGltZSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0WWVhcnNPZmZzZXQoXG4gIGFjdGl2ZURhdGU6IERhdGUsXG4gIHllYXJzSW5WaWV3OiBudW1iZXIsXG4gIG1pbkRhdGU6IERhdGUsXG4gIG1heERhdGU6IERhdGVcbik6IG51bWJlciB7XG4gIGNvbnN0IGFjdGl2ZVllYXIgPSBnZXRZZWFyKGFjdGl2ZURhdGUpO1xuICBjb25zdCB5ZWFyc0RpZmZlcmVuY2UgPSBhY3RpdmVZZWFyIC0gZ2V0U3RhcnRZZWFyKHllYXJzSW5WaWV3LCBtaW5EYXRlLCBtYXhEYXRlKTtcbiAgcmV0dXJuIG1vZHVsbyh5ZWFyc0RpZmZlcmVuY2UsIHllYXJzSW5WaWV3KTtcbn1cblxuZnVuY3Rpb24gbW9kdWxvKGE6IG51bWJlciwgYjogbnVtYmVyKTogbnVtYmVyIHtcbiAgcmV0dXJuICgoYSAlIGIpICsgYikgJSBiO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RhcnRZZWFyKHllYXJzSW5WaWV3OiBudW1iZXIsIG1pbkRhdGU6IERhdGUsIG1heERhdGU6IERhdGUpOiBudW1iZXIge1xuICBsZXQgc3RhcnRZZWFyID0gMDtcblxuICBpZiAobWF4RGF0ZSkge1xuICAgIGNvbnN0IG1heFllYXIgPSBnZXRZZWFyKG1heERhdGUpO1xuICAgIHN0YXJ0WWVhciA9IG1heFllYXIgLSB5ZWFyc0luVmlldyArIDE7XG4gIH0gZWxzZSBpZiAobWluRGF0ZSkge1xuICAgIHN0YXJ0WWVhciA9IGdldFllYXIobWluRGF0ZSk7XG4gIH1cblxuICByZXR1cm4gc3RhcnRZZWFyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNEYXRlRGlzYWJsZWQoZGF0ZTogRGF0ZSwgbWluRGF0ZTogRGF0ZSwgbWF4RGF0ZTogRGF0ZSwgZmlsdGVyOiBhbnkpOiBib29sZWFuIHtcbiAgY29uc3QgaXNCZWZvcmVNaW4gPSBtaW5EYXRlICYmIGNvbXBhcmVEYXRlcyhkYXRlLCBtaW5EYXRlKSA8PSAwO1xuICBjb25zdCBpc0FmdGVyTWF4ID0gbWF4RGF0ZSAmJiBjb21wYXJlRGF0ZXMoZGF0ZSwgbWF4RGF0ZSkgPj0gMDtcblxuICBjb25zdCBpc0Rpc2FibGVkID0gZmlsdGVyICYmIGZpbHRlcihkYXRlKSA9PT0gZmFsc2U7XG5cbiAgcmV0dXJuIGlzQmVmb3JlTWluIHx8IGlzQWZ0ZXJNYXggfHwgaXNEaXNhYmxlZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTW9udGhEaXNhYmxlZChcbiAgbW9udGg6IG51bWJlcixcbiAgeWVhcjogbnVtYmVyLFxuICBtaW5EYXRlOiBEYXRlLFxuICBtYXhEYXRlOiBEYXRlXG4pOiBib29sZWFuIHtcbiAgY29uc3QgbWF4WWVhciA9IG1heERhdGUgJiYgZ2V0WWVhcihtYXhEYXRlKTtcbiAgY29uc3QgbWF4TW9udGggPSBtYXhEYXRlICYmIGdldE1vbnRoKG1heERhdGUpO1xuICBjb25zdCBtaW5ZZWFyID0gbWluRGF0ZSAmJiBnZXRZZWFyKG1pbkRhdGUpO1xuICBjb25zdCBtaW5Nb250aCA9IG1pbkRhdGUgJiYgZ2V0TW9udGgobWluRGF0ZSk7XG5cbiAgY29uc3QgaXNNb250aEFuZFllYXJBZnRlck1heCA9XG4gICAgbWF4TW9udGggJiYgbWF4WWVhciAmJiAoeWVhciA+IG1heFllYXIgfHwgKHllYXIgPT09IG1heFllYXIgJiYgbW9udGggPiBtYXhNb250aCkpO1xuXG4gIGNvbnN0IGlzTW9udGhBbmRZZWFyQmVmb3JlTWluID1cbiAgICBtaW5Nb250aCAmJiBtaW5ZZWFyICYmICh5ZWFyIDwgbWluWWVhciB8fCAoeWVhciA9PT0gbWluWWVhciAmJiBtb250aCA8IG1pbk1vbnRoKSk7XG5cbiAgcmV0dXJuIGlzTW9udGhBbmRZZWFyQWZ0ZXJNYXggfHwgaXNNb250aEFuZFllYXJCZWZvcmVNaW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1llYXJEaXNhYmxlZCh5ZWFyOiBudW1iZXIsIG1pbkRhdGU6IERhdGUsIG1heERhdGU6IERhdGUpOiBib29sZWFuIHtcbiAgY29uc3QgbWluID0gbWluRGF0ZSAmJiBnZXRZZWFyKG1pbkRhdGUpO1xuICBjb25zdCBtYXggPSBtYXhEYXRlICYmIGdldFllYXIobWF4RGF0ZSk7XG5cbiAgY29uc3QgaXNBZnRlck1heCA9IG1heCAmJiB5ZWFyID4gbWF4O1xuICBjb25zdCBpc0JlZm9yZU1pbiA9IG1pbiAmJiB5ZWFyIDwgbWluO1xuXG4gIHJldHVybiBpc0FmdGVyTWF4IHx8IGlzQmVmb3JlTWluO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOZXh0RGF0ZURpc2FibGVkKFxuICBhY3RpdmVEYXRlOiBEYXRlLFxuICB2aWV3OiBzdHJpbmcsXG4gIHllYXJzSW5WaWV3OiBudW1iZXIsXG4gIG1pbkRhdGU6IERhdGUsXG4gIG1heERhdGU6IERhdGVcbik6IGJvb2xlYW4ge1xuICByZXR1cm4gbWF4RGF0ZSAmJiBhcmVEYXRlc0luU2FtZVZpZXcoYWN0aXZlRGF0ZSwgbWF4RGF0ZSwgdmlldywgeWVhcnNJblZpZXcsIG1pbkRhdGUsIG1heERhdGUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNQcmV2aW91c0RhdGVEaXNhYmxlZChcbiAgYWN0aXZlRGF0ZTogRGF0ZSxcbiAgdmlldzogc3RyaW5nLFxuICB5ZWFyc0luVmlldzogbnVtYmVyLFxuICBtaW5EYXRlOiBEYXRlLFxuICBtYXhEYXRlOiBEYXRlXG4pOiBib29sZWFuIHtcbiAgcmV0dXJuIG1pbkRhdGUgJiYgYXJlRGF0ZXNJblNhbWVWaWV3KGFjdGl2ZURhdGUsIG1pbkRhdGUsIHZpZXcsIHllYXJzSW5WaWV3LCBtaW5EYXRlLCBtYXhEYXRlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFyZURhdGVzSW5TYW1lVmlldyhcbiAgZGF0ZTE6IERhdGUsXG4gIGRhdGUyOiBEYXRlLFxuICB2aWV3OiBzdHJpbmcsXG4gIHllYXJzSW5WaWV3OiBudW1iZXIsXG4gIG1pbkRhdGU6IERhdGUsXG4gIG1heERhdGU6IERhdGVcbik6IGJvb2xlYW4ge1xuICBpZiAodmlldyA9PT0gJ2RheXMnKSB7XG4gICAgcmV0dXJuIGdldFllYXIoZGF0ZTEpID09PSBnZXRZZWFyKGRhdGUyKSAmJiBnZXRNb250aChkYXRlMSkgPT09IGdldE1vbnRoKGRhdGUyKTtcbiAgfVxuXG4gIGlmICh2aWV3ID09PSAnbW9udGhzJykge1xuICAgIHJldHVybiBnZXRZZWFyKGRhdGUxKSA9PT0gZ2V0WWVhcihkYXRlMik7XG4gIH1cblxuICBpZiAodmlldyA9PT0gJ3llYXJzJykge1xuICAgIGNvbnN0IHN0YXJ0WWVhciA9IGdldFN0YXJ0WWVhcih5ZWFyc0luVmlldywgbWluRGF0ZSwgbWF4RGF0ZSk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgTWF0aC5mbG9vcigoZ2V0WWVhcihkYXRlMSkgLSBzdGFydFllYXIpIC8geWVhcnNJblZpZXcpID09PVxuICAgICAgTWF0aC5mbG9vcigoZ2V0WWVhcihkYXRlMikgLSBzdGFydFllYXIpIC8geWVhcnNJblZpZXcpXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cbiJdfQ==